#!/bin/sh

export LANG=C
export LC_ALL=C

list="/etc/apt/sources.list.d/omv-extras-org.list"
armbian="/etc/apt/sources.list.d/armbian.list"
rpi="/etc/apt/preferences.d/99raspberrypiorg"

if [ -f "${list}" ]; then
  sed -i "s/jessie/stretch/g" ${list}
  sed -i "s/erasmus/arrakis/g" ${list}
  sed -i "s/ce-docker/docker/g" ${list}
fi

if [ -f "${armbian}" ]; then
  sed -i "s/jessie/stretch/g" ${armbian}
fi

if [ -f "${rpi}" ]; then
  cat <<EOF > ${rpi}
Package: firmware-brcm80211 libraspberrypi-bin libraspberrypi0 raspberrypi-bootloader raspberrypi-kernel
Pin: release o=Raspberry Pi Foundation,a=stable,n=stretch, origin archive.raspberrypi.org
Pin-Priority: 1000

Package: *
Pin: release o=Raspberry Pi Foundation,a=stable,n=stretch, origin archive.raspberrypi.org
Pin-Priority: 10

Package: *
Pin: release n=stretch, origin httpredir.debian.org
Pin-Priority: 900
EOF
fi

exit 0
